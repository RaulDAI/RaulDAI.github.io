<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Retos Academia</title>

    <!-- Estilos propios -->
    <link rel="stylesheet" href="retos.css"/>

    <!-- Lucide Icons -->
    <!-- Cargamos Lucide @0.487.0 desde unpkg sin 'integrity' por posibles cambios binarios que rompen SRI.
         Si se aplica CSP o se autohospeda, revisar esta decisión. -->
    <script src="https://unpkg.com/lucide@0.487.0"></script>

</head>
<body>

<!-- Botón para abrir el menú -->
<button class="openbtn" id="menuToggle" onclick="toggleNav()" aria-label="Abrir menú lateral" aria-expanded="false"
        aria-controls="mySidenav">
    ☰
</button>

<!-- Menú lateral -->
<nav id="mySidenav" class="sidenav" aria-label="Menú principal" role="navigation">
    <button type="button" onclick="mostrarSeccion('retos')" data-seccion="retos" class="nav-btn activo">
        <i data-lucide="list-check" class="icono"></i> Retos
    </button>
    <button type="button" onclick="mostrarSeccion('graficos')" data-seccion="graficos" class="nav-btn">
        <i data-lucide="bar-chart-3" class="icono"></i> Gráficos
    </button>
</nav>

<!-- Contenido principal -->
<main id="main" tabindex="-1">

    <!-- Sección Retos -->
    <section class="seccion" id="seccion-retos">
        <div class="centrado-columna">
            <div class="ancho-contenido">

                <!-- Retos Header alineado a la izquierda -->
                <div class="retos-header">
                    <h1 class="titulo titulo-con-boton">
                        Retos JuanK [Aprendiz - Nv 1]
                        <button class="btn-mas" id="btnAgregarReto" aria-label="Agregar nuevo reto">
                            <i data-lucide="plus"></i>
                        </button>

                    </h1>
                </div>

                <!-- Tabla -->
                <div class="tabla-retos">
                    <table>
                        <thead>
                        <tr>
                            <th class="col-numero">#</th>
                            <th class="col-nombre"><i data-lucide="file-text"></i> Nombre</th>
                            <th class="col-etapa"><i data-lucide="layers"></i> Etapa</th>
                            <th class="col-tiempo-estimado"><i data-lucide="clock"></i> t Estimado</th>
                            <th class="col-tiempo-real"><i data-lucide="alarm-clock"></i> t Real</th>
                            <th class="col-fecha-inicial"><i data-lucide="calendar-days"></i> Fecha Inicial</th>
                            <th class="col-fecha-final"><i data-lucide="calendar-check"></i> Fecha Final</th>
                            <th class="col-puntos"><i data-lucide="star"></i> Puntos</th>
                            <th class="col-insignia"><i data-lucide="medal"></i> Insignia</th>
                            <th class="col-eliminar"><i data-lucide="trash-2"></i></th>
                        </tr>
                        </thead>
                        <tbody id="tabla-cuerpo-retos">
                        <!-- Se llena dinámicamente desde retos.js -->
                        <!-- Ejemplo de fila:
                        <tr>
                            ...
                            <td class="celda-puntos"><span class="valor-puntos">0</span></td>
                            ...
                        </tr>
                        -->
                        </tbody>
                    </table>
                </div>


            </div>
        </div>
    </section>

    <!-- Sección Gráficos -->
    <section class="seccion hidden" id="seccion-graficos">
        <div class="centrado-columna">
            <div class="ancho-contenido">
                <h1 class="titulo">Gráficos</h1>
                <p>Aquí se mostrarán los gráficos de desempeño.</p>
            </div>
        </div>
    </section>

</main>

<!-- Scripts principales -->
<script src="retos.js" defer></script>

<!-- Inicialización general -->
<script>
    document.addEventListener("DOMContentLoaded", () => {
        lucide.createIcons();
        mostrarSeccion('retos');
        document.querySelector('[data-seccion="retos"]')?.classList.add('activo');
    });
</script>

<!-- Modal para sumar tiempo real -->
<div id="modal-tiempo" class="modal-overlay hidden" onclick="cerrarModal(event)">
    <div class="modal-contenido" onclick="event.stopPropagation()">
        <h2 class="modal-titulo">Sumar a Tiempo Real</h2>

        <div class="tiempo-input">
            <input type="text" id="inputHoras" data-tipo="horas" maxlength="2" inputmode="numeric"
                   oninput="filtrarNumeros(this)" onblur="normalizarDosDigitos(this)" value="00"/> :
            <input type="text" id="inputMinutos" data-tipo="minutos" maxlength="2" inputmode="numeric"
                   oninput="filtrarNumeros(this)" onblur="normalizarDosDigitos(this)" value="00"/>
        </div>

        <div class="modal-botones">
            <button onclick="confirmarSumaTiempo()" class="btn-confirmar">Sumar</button>
            <button onclick="cerrarModal()" class="btn-cancelar">Cancelar</button>
        </div>
    </div>
</div>

</body>
</html>
